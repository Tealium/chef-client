#!/bin/bash
mypid=$$
(
  if pgrep $(basename $0) | grep -vP "^${mypid}|grep|cron|ppid=${mypid}" | grep -q $(basename $0); then
    echo $(date) Running chef-client
    /usr/bin/chef-client
  else
    echo $(date) skipping chef run, client already running
  fi
) >> /var/log/tealium/chef_cron.log 2>> /var/log/tealium/chef_cron_err.log
